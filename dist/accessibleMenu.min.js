var AccessibleMenu=function(){"use strict";var e,t,s,n;function r(e){let t="element";try{if(e instanceof HTMLElement)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,!(e[s]instanceof HTMLElement))throw Error}catch(e){throw new TypeError(`${t} must be an HTML Element.`)}}function o(e){u(e);let t="value";try{if("object"==typeof e)for(const s in e){if(t=s,"string"!=typeof e[s])throw Error;document.querySelector(e[s])}else document.querySelector(e);return!0}catch(e){throw new TypeError(`${t} must be a valid CSS selector.`)}}function l(e){let t="value";try{if("boolean"==typeof e)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,"boolean"!=typeof e[s])throw Error}catch(e){throw new TypeError(`${t} must be a boolean.`)}}function i(e){let t="value";try{if("number"==typeof e)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,"number"!=typeof e[s])throw Error}catch(e){throw new TypeError(`${t} must be a number.`)}}function u(e){let t="value";try{if("string"==typeof e)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,"string"!=typeof e[s])throw Error}catch(e){throw new TypeError(`${t} must be a string.`)}}function h(e){let t="element";try{if(e instanceof g)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,!(e[s]instanceof g))throw Error}catch(e){throw new TypeError(`${t} must be an instance of either BaseMenu, Menubar, or DisclosureMenu`)}}function m(e,t){u(e),r(t);return void 0!==t[`on${e}`]}function c(e){let t="value";try{if("string"==typeof e)return!0;if("object"==typeof e){for(const s in e)if(t=s,"string"!=typeof e[s]){if(!Array.isArray(e[s]))throw Error;e[s].forEach((e=>{u(e)}))}}else{if(!Array.isArray(e))throw Error;u(e)}}catch(e){throw new TypeError(`${t} must be either a string or an array of strings.`)}}Array.from||(Array.from=(e=Object.prototype.toString,t=function(t){return"function"==typeof t||"[object Function]"===e.call(t)},s=Math.pow(2,53)-1,n=function(e){var t=function(e){var t=Number(e);return isNaN(t)?0:0!==t&&isFinite(t)?(t>0?1:-1)*Math.floor(Math.abs(t)):t}(e);return Math.min(Math.max(t,0),s)},function(e){var s=this,r=Object(e);if(null==e)throw new TypeError("Array.from requires an array-like object - not null or undefined");var o,l=arguments.length>1?arguments[1]:void 0;if(void 0!==l){if(!t(l))throw new TypeError("Array.from: when provided, the second argument must be a function");arguments.length>2&&(o=arguments[2])}for(var i,u=n(r.length),h=t(s)?Object(new s(u)):new Array(u),m=0;m<u;)i=r[m],h[m]=l?void 0===o?l(i,m):l.call(o,i,m):i,m+=1;return h.length=u,h})),Array.includes||(Array.prototype.includes=function(e){return!!~this.indexOf(e)}),Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(e){if(null==this)throw TypeError('"this" is null or not defined');var t=Object(this),s=t.length>>>0;if("function"!=typeof e)throw TypeError("predicate must be a function");for(var n=arguments[1],r=0;r<s;){var o=t[r];if(e.call(n,o,r,t))return o;r++}},configurable:!0,writable:!0}),String.prototype.startsWith||Object.defineProperty(String.prototype,"startsWith",{value:function(e,t){var s=t>0?0|t:0;return this.substring(s,s+e.length)===e}}),String.prototype.endsWith||(String.prototype.endsWith=function(e,t){return(void 0===t||t>this.length)&&(t=this.length),this.substring(t-e.length,t)===e}),function(){if("function"==typeof window.CustomEvent)return!1;window.CustomEvent=function(e,t){t=t||{bubbles:!1,cancelable:!1,detail:null};var s=document.createEvent("CustomEvent");return s.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),s}}();class a{constructor({menuToggleElement:e,parentElement:t,controlledMenu:s,openClass:n="show",closeClass:o="hide",parentMenu:l=null}){r({menuToggleElement:e,parentElement:t}),h(null!==l?{controlledMenu:s,parentMenu:l}:{controlledMenu:s}),this.domElements={toggle:e,parent:t},this.menuElements={controlledMenu:s,parentMenu:l},this.openClass=n||"",this.closeClass=o||"",this.isOpen=!1,this.expandEvent=new CustomEvent("accessibleMenuExpand",{bubbles:!0,detail:{toggle:this}}),this.collapseEvent=new CustomEvent("accessibleMenuCollapse",{bubbles:!0,detail:{toggle:this}}),this.initialize()}initialize(){if(this.dom.toggle.setAttribute("aria-haspopup","true"),this.dom.toggle.setAttribute("aria-expanded","false"),function(e,t){u(e),r(t);const s=e.toLowerCase();if(t instanceof HTMLElement)return t.tagName.toLowerCase()===s;{let e=!0;for(const n in t)t[n].tagName.toLowerCase()!==s&&(e=!1);return e}}("button",this.dom.toggle)||this.dom.toggle.setAttribute("role","button"),""===this.dom.toggle.id||""===this.elements.controlledMenu.dom.menu.id){const e=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,10);let t=this.dom.toggle.innerText.replace(/[^a-zA-Z0-9\s]/g,""),s=e;!t.replace(/\s/g,"").length&&this.dom.toggle.getAttribute("aria-label")&&(t=this.dom.toggle.getAttribute("aria-label").replace(/[^a-zA-Z0-9\s]/g,"")),t.replace(/\s/g,"").length>0&&(t=t.toLowerCase().replace(/\s+/g,"-"),t.startsWith("-")&&(t=t.substring(1)),t.endsWith("-")&&(t=t.slice(0,-1)),s=`${t}-${s}`),this.dom.toggle.id=this.dom.toggle.id||`${s}-menu-button`,this.elements.controlledMenu.dom.menu.id=this.elements.controlledMenu.dom.menu.id||`${s}-menu`}this.elements.controlledMenu.dom.menu.setAttribute("aria-labelledby",this.dom.toggle.id),this.dom.toggle.setAttribute("aria-controls",this.elements.controlledMenu.dom.menu.id),""!==this.closeClass&&("string"==typeof this.closeClass?this.elements.controlledMenu.dom.menu.classList.add(this.closeClass):Array.isArray(this.closeClass)&&this.closeClass.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)})))}get dom(){return this.domElements}get elements(){return this.menuElements}get isOpen(){return this.show}get openClass(){return this.controlledMenuOpenClass}get closeClass(){return this.controlledMenuCloseClass}set isOpen(e){l({value:e}),this.show=e}set openClass(e){c({openClass:e}),this.controlledMenuOpenClass=e}set closeClass(e){c({closeClass:e}),this.controlledMenuCloseClass=e}expand(){this.dom.toggle.setAttribute("aria-expanded","true"),""!==this.openClass&&("string"==typeof this.openClass?this.elements.controlledMenu.dom.menu.classList.add(this.openClass):Array.isArray(this.openClass)&&this.openClass.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)}))),""!==this.closeClass&&("string"==typeof this.closeClass?this.elements.controlledMenu.dom.menu.classList.remove(this.closeClass):Array.isArray(this.closeClass)&&this.closeClass.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.remove(e)}))),this.dom.toggle.dispatchEvent(this.expandEvent)}collapse(){this.dom.toggle.setAttribute("aria-expanded","false"),""!==this.closeClass&&("string"==typeof this.closeClass?this.elements.controlledMenu.dom.menu.classList.add(this.closeClass):Array.isArray(this.closeClass)&&this.closeClass.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.add(e)}))),""!==this.openClass&&("string"==typeof this.openClass?this.elements.controlledMenu.dom.menu.classList.remove(this.openClass):Array.isArray(this.openClass)&&this.openClass.forEach((e=>{this.elements.controlledMenu.dom.menu.classList.remove(e)}))),this.dom.toggle.dispatchEvent(this.collapseEvent)}open(){this.isOpen=!0,this.expand(),this.closeSiblings(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="child"),this.elements.controlledMenu.focusState="self"}preview(){this.isOpen=!0,this.expand(),this.closeSiblings(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"),this.elements.controlledMenu.focusState="none"}close(){this.isOpen&&(this.isOpen=!1,this.collapse(),this.closeChildren(),this.elements.controlledMenu.currentChild=0,this.elements.controlledMenu.blur(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"))}toggle(){this.isOpen?this.close():this.open()}closeSiblings(){this.elements.parentMenu&&this.elements.parentMenu.elements.submenuToggles.forEach((e=>{e!==this&&e.close()}))}closeChildren(){this.elements.controlledMenu.elements.submenuToggles.forEach((e=>e.close()))}}class d{constructor({menuItemElement:e,menuLinkElement:t,parentMenu:s,isSubmenuItem:n=!1,childMenu:o=null,toggle:i=null}){r({menuItemElement:e,menuLinkElement:t}),l({isSubmenuItem:n}),h(null!==o?{parentMenu:s,childMenu:o}:{parentMenu:s}),null!==i&&function(e){let t="element";try{if(e instanceof a)return!0;if("object"!=typeof e||e instanceof a)throw Error;for(const s in e)if(t=s,!(e[s]instanceof a))throw Error}catch(e){throw new TypeError(`${t} must be a MenuToggle.`)}}({toggle:i}),this.domElements={item:e,link:t},this.menuElements={parentMenu:s,childMenu:o,toggle:i},this.isController=n,this.initialize()}initialize(){this.isMenubar=this.elements.parentMenu instanceof b,this.isMenubar&&(this.dom.item.setAttribute("role","none"),this.dom.link.setAttribute("role","menuitem"),this.dom.link.tabIndex=-1)}get dom(){return this.domElements}get elements(){return this.menuElements}get isSubmenuItem(){return this.isController}focus(){"mouse"!==this.elements.parentMenu.currentEvent&&this.dom.link.focus(),this.isMenubar&&this.elements.parentMenu.isTopLevel&&(this.dom.link.tabIndex=0)}blur(){"mouse"!==this.elements.parentMenu.currentEvent&&this.dom.link.blur(),this.isMenubar&&this.elements.parentMenu.isTopLevel&&(this.dom.link.tabIndex=-1)}}function f(e){!function(e){let t="event";try{if(e instanceof KeyboardEvent)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,!(e[s]instanceof KeyboardEvent))throw Error}catch(e){throw new TypeError(`${t} must be a KeyboardEvent.`)}}(e);try{const t=e.key||e.keyCode,s={Enter:"Enter"===t||13===t,Space:" "===t||"Spacebar"===t||32===t,Escape:"Escape"===t||"Esc"===t||27===t,ArrowUp:"ArrowUp"===t||"Up"===t||38===t,ArrowRight:"ArrowRight"===t||"Right"===t||39===t,ArrowDown:"ArrowDown"===t||"Down"===t||40===t,ArrowLeft:"ArrowLeft"===t||"Left"===t||37===t,Home:"Home"===t||36===t,End:"End"===t||35===t,Character:!!t.match(/^[a-zA-Z]{1}$/),Tab:"Tab"===t||9===t};return Object.keys(s).find((e=>!0===s[e]))}catch(e){return""}}function p(e){!function(e){let t="event";try{if(e instanceof Event)return!0;if("object"!=typeof e)throw Error;for(const s in e)if(t=s,!(e[s]instanceof Event))throw Error}catch(e){throw new TypeError(`${t} must be an Event.`)}}(e),e.preventDefault(),e.stopPropagation()}class g{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:s="a",submenuItemSelector:n="",submenuToggleSelector:i="a",submenuSelector:u="ul",controllerElement:m=null,containerElement:c=null,openClass:a="show",closeClass:d="hide",isTopLevel:f=!0,parentMenu:p=null,isHoverable:g=!1,hoverDelay:b=250}){l({isTopLevel:f}),o(""!==n?{menuItemSelector:t,menuLinkSelector:s,submenuItemSelector:n,submenuToggleSelector:i,submenuSelector:u}:{menuItemSelector:t,menuLinkSelector:s}),r(null!==m||null!==c?{menuElement:e,controllerElement:m,containerElement:c}:{menuElement:e}),null!==p&&h({parentMenu:p}),this.domElements={menu:e,menuItems:[],submenuItems:[],submenuToggles:[],submenus:[],controller:m,container:c},this.domSelectors={menuItems:t,menuLinks:s,submenuItems:n,submenuToggles:i,submenus:u},this.menuElements={menuItems:[],submenuToggles:[],controller:null,parentMenu:p,rootMenu:f?this:null},this.openClass=a||"",this.closeClass=d||"",this.root=f,this.currentChild=0,this.focusState="none",this.currentEvent="none",this.isHoverable=g,this.hoverDelay=b,this.initialize()}initialize(){if(null===this.elements.rootMenu&&this.findRootMenu(this),this.setDOMElements(),this.isTopLevel&&this.dom.controller&&this.dom.container){const e=new a({menuToggleElement:this.dom.controller,parentElement:this.dom.container,controlledMenu:this,openClass:this.openClass,closeClass:this.closeClass});this.menuElements.controller=e}}get dom(){return this.domElements}get selectors(){return this.domSelectors}get elements(){return this.menuElements}get openClass(){return this.submenuOpenClass}get closeClass(){return this.submenuCloseClass}get isTopLevel(){return this.root}get currentChild(){return this.focussedChild}get focusState(){return this.state}get currentEvent(){return this.event}get currentMenuItem(){return this.elements.menuItems[this.currentChild]}get isHoverable(){return this.hoverable}get hoverDelay(){return this.delay}set openClass(e){c({openClass:e}),this.submenuOpenClass=e}set closeClass(e){c({closeClass:e}),this.submenuCloseClass=e}set currentChild(e){i({value:e}),this.focussedChild=e}set focusState(e){!function(e){u(e);const t=["none","self","child"];let s="value";try{if("object"!=typeof e){if(t.includes(e))return!0;throw Error}for(const n in e)if(s=n,!t.includes(e[n]))throw Error}catch(e){throw new Error(`${s} must be one of the following values: ${t.join(", ")}`)}}({value:e}),this.state=e}set currentEvent(e){!function(e){u(e);const t=["none","mouse","keyboard"];let s="value";try{if("object"!=typeof e){if(t.includes(e))return!0;throw Error}for(const n in e)if(s=n,!t.includes(e[n]))throw Error}catch(e){throw new Error(`${s} must be one of the following values: ${t.join(", ")}`)}}({value:e}),this.event=e}set isHoverable(e){l({value:e}),this.hoverable=e}set hoverDelay(e){i({value:e}),this.delay=e}setDOMElementType(e,t,s){if("string"!=typeof this.selectors[e])throw new Error(`${e} is not a valid element type within the menu.`);{t&&r({base:t});const n=t||this.dom.menu,o=e=>e.parentElement===n,l=this.selectors[e],i=Array.from(n.querySelectorAll(l));this.domElements[e]=void 0!==s?"function"==typeof s?i.filter((e=>s(e))):i:i.filter((e=>o(e)))}}addDOMElementType(e,t,s){if("string"!=typeof this.selectors[e])throw new Error(`${e} is not a valid element type within the menu.`);{t&&r({base:t});const n=t||this.dom.menu,o=e=>e.parentElement===n,l=this.selectors[e],i=Array.from(n.querySelectorAll(l));this.domElements[e]=void 0!==s?"function"==typeof s?[...this.domElements[e],...i.filter((e=>s(e)))]:[...this.domElements[e],...i]:[...this.domElements[e],...i.filter((e=>o(e)))]}}clearDOMElementType(e){if("menu"!==e)if(Array.isArray(this.domElements[e]))this.domElements[e]=[];else{if(void 0===this.domElements[e])throw new Error(`${e} is not a valid element type within the menu.`);this.domElements[e]=null}}setDOMElements(){this.setDOMElementType("menuItems"),""!==this.selectors.submenuItems&&(this.setDOMElementType("submenuItems"),this.clearDOMElementType("submenuToggles"),this.clearDOMElementType("submenus"),this.dom.submenuItems.forEach((e=>{this.addDOMElementType("submenuToggles",e),this.addDOMElementType("submenus",e)})))}findRootMenu(e){if(e.isTopLevel)this.menuElements.rootMenu=e;else{if(null===e.elements.parentMenu)throw new Error("Cannot find root menu.");this.findRootMenu(e.elements.parentMenu)}}createChildElements(e=g){this.dom.menuItems.forEach((t=>{let s;if(this.dom.submenuItems.includes(t)){const n=t.querySelector(this.selectors.submenuToggles),r=t.querySelector(this.selectors.submenus),o=new e({menuElement:r,menuItemSelector:this.selectors.menuItems,menuLinkSelector:this.selectors.menuLinks,submenuItemSelector:this.selectors.submenuItems,submenuToggleSelector:this.selectors.submenuToggles,submenuSelector:this.selectors.submenus,openClass:this.openClass,closeClass:this.closeClass,isTopLevel:!1,parentMenu:this,isHoverable:this.isHoverable,hoverDelay:this.hoverDelay}),l=new a({menuToggleElement:n,parentElement:t,controlledMenu:o,openClass:this.openClass,closeClass:this.closeClass,parentMenu:this});this.menuElements.submenuToggles.push(l),s=new d({menuItemElement:t,menuLinkElement:n,parentMenu:this,isSubmenuItem:!0,childMenu:o,toggle:l})}else{const e=t.querySelector(this.selectors.menuLinks);s=new d({menuItemElement:t,menuLinkElement:e,parentMenu:this})}this.menuElements.menuItems.push(s)}))}handleFocus(){this.elements.menuItems.forEach(((e,t)=>{e.dom.link.addEventListener("focus",(()=>{this.elements.parentMenu&&(this.elements.parentMenu.focusState="child"),e.elements.childMenu&&(e.elements.childMenu.focusState="none"),this.focusState="self",this.currentChild=t}))}))}handleClick(){const e=m("touchstart",this.dom.menu)?"touchstart":"mousedown",t=m("touchend",this.dom.menu)?"touchend":"mouseup";function s(e,t,s){p(s),t.toggle(),t.isOpen&&(e.focusState="self",t.elements.controlledMenu.focusState="none")}document.addEventListener(t,(e=>{"none"!==this.focusState&&(this.currentEvent="mouse",this.dom.menu.contains(e.target)||!this.dom.menu===e.target||(this.closeChildren(),this.blur(),this.elements.controller&&this.elements.controller.close()))})),this.elements.menuItems.forEach(((n,r)=>{n.dom.link.addEventListener(e,(()=>{this.currentEvent="mouse",this.elements.rootMenu.blurChildren(),this.focusChild(r)})),n.isSubmenuItem&&(n.elements.toggle.dom.toggle[`on${t}`]=e=>{this.currentEvent="mouse",s(this,n.elements.toggle,e)})})),this.isTopLevel&&this.elements.controller&&(this.elements.controller.dom.toggle[`on${t}`]=e=>{this.currentEvent="mouse",s(this,this.elements.controller,e)})}handleHover(){this.elements.submenuToggles.forEach((e=>{e.dom.parent.addEventListener("mouseenter",(()=>{this.isHoverable&&(this.currentEvent="mouse",e.open())})),e.dom.parent.addEventListener("mouseleave",(()=>{this.isHoverable&&setTimeout((()=>{this.currentEvent="mouse",e.close()}),this.hoverDelay)}))}))}handleKeydown(){this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=f(e);"Space"!==t&&"Enter"!==t||p(e)}))}handleKeyup(){this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=f(e);"Space"!==t&&"Enter"!==t||(p(e),this.elements.controller.open(),this.focusFirstChild())}))}focus(){this.focusState="self","mouse"!==this.currentEvent&&this.dom.menu.focus()}blur(){this.focusState="none","mouse"!==this.currentEvent&&this.dom.menu.blur(),this.isTopLevel&&this.elements.controller&&this.elements.controller.close()}focusFirstChild(){this.blurCurrentChild(),this.currentChild=0,this.focusCurrentChild()}focusLastChild(){this.blurCurrentChild(),this.currentChild=this.elements.menuItems.length-1,this.focusCurrentChild()}focusNextChild(){this.currentChild===this.elements.menuItems.length-1?this.focusFirstChild():(this.blurCurrentChild(),this.currentChild=this.currentChild+1,this.focusCurrentChild())}focusPreviousChild(){0===this.currentChild?this.focusLastChild():(this.blurCurrentChild(),this.currentChild=this.currentChild-1,this.focusCurrentChild())}focusCurrentChild(){-1!==this.currentChild&&this.currentMenuItem.focus()}blurCurrentChild(){-1!==this.currentChild&&this.currentMenuItem.blur()}focusNextChildWithCharacter(e){const t=e.toLowerCase();let s=this.currentChild+1,n=!1;for(;!n&&s<this.elements.menuItems.length;){this.elements.menuItems[s].dom.item.innerText.toLowerCase().startsWith(t)&&(n=!0,this.currentChild=s,this.focusCurrentChild()),s++}}focusController(){this.dom.controller&&("mouse"!==this.currentEvent&&this.dom.controller.focus(),this.focusState="none")}focusContainer(){this.dom.container&&("mouse"!==this.currentEvent&&this.dom.container.focus(),this.focusState="none")}closeChildren(){this.elements.submenuToggles.forEach((e=>e.close()))}blurChildren(){this.elements.menuItems.forEach((e=>{e.blur(),e.isSubmenuItem&&e.elements.childMenu.blurChildren()}))}}class b extends g{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:s="a",submenuItemSelector:n="",submenuToggleSelector:r="a",submenuSelector:o="ul",controllerElement:l=null,containerElement:i=null,openClass:u="show",closeClass:h="hide",isTopLevel:m=!0,parentMenu:c=null,isHoverable:a=!1,hoverDelay:d=250}){super({menuElement:e,menuItemSelector:t,menuLinkSelector:s,submenuItemSelector:n,submenuToggleSelector:r,submenuSelector:o,controllerElement:l,containerElement:i,openClass:u,closeClass:h,isTopLevel:m,parentMenu:c,isHoverable:a,hoverDelay:d})}initialize(){super.initialize(),this.dom.menu.setAttribute("role","menubar"),this.createChildElements(b),this.handleFocus(),this.handleClick(),this.isHoverable&&this.handleHover(),this.handleKeydown(),this.handleKeyup(),this.elements.menuItems[0].dom.link.tabIndex=0}handleKeydown(){super.handleKeydown(),this.dom.menu.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=f(e);if("Tab"===t&&("none"!==this.elements.rootMenu.focusState?(this.elements.rootMenu.blur(),this.elements.rootMenu.closeChildren()):this.elements.rootMenu.focus()),"Character"===t)p(e);else if(this.isTopLevel){if("self"===this.focusState){const s=["Space","Enter","ArrowDown","ArrowUp"],n=["Escape"];(["ArrowRight","ArrowLeft","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&s.includes(t)||this.elements.controller&&n.includes(t))&&p(e)}}else{const s=["Space","Enter"];(["Escape","ArrowRight","ArrowLeft","ArrowDown","ArrowUp","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&s.includes(t))&&p(e)}}))}handleKeyup(){super.handleKeyup(),this.dom.menu.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=f(e),{altKey:s,crtlKey:n,metaKey:r}=e;if("Character"!==t||(s||n||r))if(this.isTopLevel){if("self"===this.focusState)if("Space"===t||"Enter"===t)this.currentMenuItem.isSubmenuItem&&(p(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()})));else if("ArrowRight"===t){p(e);const t=this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen;this.focusNextChild(),t&&(this.currentMenuItem.isSubmenuItem?this.currentMenuItem.elements.toggle.preview():this.closeChildren())}else if("ArrowLeft"===t){p(e);const t=this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen;this.focusPreviousChild(),t&&(this.currentMenuItem.isSubmenuItem?this.currentMenuItem.elements.toggle.preview():this.closeChildren())}else if("ArrowDown"===t)this.currentMenuItem.isSubmenuItem&&(p(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()})));else if("ArrowUp"===t)this.currentMenuItem.isSubmenuItem&&(p(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusLastChild()})));else if("Home"===t)p(e),this.focusFirstChild();else if("End"===t)p(e),this.focusLastChild();else if("Escape"===t){this.elements.submenuToggles.some((e=>e.isOpen))?(p(e),this.closeChildren()):this.isTopLevel&&this.elements.controller&&this.elements.controller.isOpen&&(p(e),this.elements.controller.close(),this.focusController())}}else"Space"===t||"Enter"===t?this.currentMenuItem.isSubmenuItem&&(p(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()}))):"Escape"===t?(p(e),this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusCurrentChild()):"ArrowRight"===t?this.currentMenuItem.isSubmenuItem?(p(e),this.currentMenuItem.elements.toggle.open(),requestAnimationFrame((()=>{this.currentMenuItem.elements.childMenu.focusFirstChild()}))):(p(e),this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusNextChild(),this.elements.rootMenu.currentMenuItem.isSubmenuItem&&this.elements.rootMenu.currentMenuItem.elements.toggle.preview()):"ArrowLeft"===t?this.elements.parentMenu.currentMenuItem.isSubmenuItem&&(p(e),this.elements.parentMenu.currentMenuItem.elements.toggle.close(),this.elements.parentMenu.focusCurrentChild(),this.elements.parentMenu===this.elements.rootMenu&&(this.elements.rootMenu.closeChildren(),this.elements.rootMenu.focusPreviousChild(),this.elements.rootMenu.currentMenuItem.isSubmenuItem&&this.elements.rootMenu.currentMenuItem.elements.toggle.preview())):"ArrowDown"===t?(p(e),this.focusNextChild()):"ArrowUp"===t?(p(e),this.focusPreviousChild()):"Home"===t?(p(e),this.focusFirstChild()):"End"===t&&(p(e),this.focusLastChild());else p(e),this.focusNextChildWithCharacter(e.key)}))}}class C extends g{constructor({menuElement:e,menuItemSelector:t="li",menuLinkSelector:s="a",submenuItemSelector:n="",submenuToggleSelector:r="a",submenuSelector:o="ul",controllerElement:l=null,containerElement:i=null,openClass:u="show",closeClass:h="hide",isTopLevel:m=!0,parentMenu:c=null,isHoverable:a=!1,hoverDelay:d=250}){super({menuElement:e,menuItemSelector:t,menuLinkSelector:s,submenuItemSelector:n,submenuToggleSelector:r,submenuSelector:o,controllerElement:l,containerElement:i,openClass:u,closeClass:h,isTopLevel:m,parentMenu:c,isHoverable:a,hoverDelay:d}),this.currentChild=-1}initialize(){super.initialize(),this.createChildElements(C),this.handleFocus(),this.handleClick(),this.isHoverable&&this.handleHover(),this.handleKeydown(),this.handleKeyup()}handleKeydown(){super.handleKeydown(),this.dom.menu.addEventListener("keydown",(e=>{this.currentEvent="keyboard";const t=f(e);if("self"===this.focusState){const s=["Space","Enter"],n=["Escape"],r=["Escape"];(["ArrowUp","ArrowRight","ArrowDown","ArrowLeft","Home","End"].includes(t)||this.currentMenuItem.isSubmenuItem&&s.includes(t)||this.elements.controller&&n.includes(t)||this.elements.parentMenu&&r.includes(t))&&p(e)}}))}handleKeyup(){super.handleKeyup(),this.dom.menu.addEventListener("keyup",(e=>{this.currentEvent="keyboard";const t=f(e);if("self"===this.focusState)if("Space"===t||"Enter"===t)this.currentMenuItem.isSubmenuItem&&(p(e),this.currentMenuItem.elements.toggle.preview());else if("Escape"===t){this.elements.submenuToggles.some((e=>e.isOpen))?(p(e),this.closeChildren()):this.elements.parentMenu?(p(e),this.elements.parentMenu.closeChildren(),this.elements.parentMenu.focusCurrentChild()):this.isTopLevel&&this.elements.controller&&this.elements.controller.isOpen&&(this.elements.controller.close(),this.focusController())}else"ArrowDown"===t||"ArrowRight"===t?(p(e),this.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.toggle.isOpen?this.currentMenuItem.elements.childMenu.focusFirstChild():this.focusNextChild()):"ArrowUp"===t||"ArrowLeft"===t?(p(e),this.focusPreviousChild()):"Home"===t?(p(e),this.focusFirstChild()):"End"===t&&(p(e),this.focusLastChild())}))}focusNextChild(){this.currentChild<this.elements.menuItems.length-1&&(this.blurCurrentChild(),this.currentChild=this.currentChild+1,this.focusCurrentChild())}focusPreviousChild(){this.currentChild>0&&(this.blurCurrentChild(),this.currentChild=this.currentChild-1,this.focusCurrentChild())}}return{Menubar:b,DisclosureMenu:C}}();
