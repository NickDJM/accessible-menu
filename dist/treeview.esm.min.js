function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},e(t)}function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function o(e,t,o){return t&&n(e.prototype,t),o&&n(e,o),e}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}function l(e){return l=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},l(e)}function i(e,t){return i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},i(e,t)}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,o=l(e);if(t){var r=l(this).constructor;n=Reflect.construct(o,arguments,r)}else n=o.apply(this,arguments);return c(this,n)}}function a(e,t,n){return a="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(e,t,n){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=l(e)););return e}(e,t);if(o){var r=Object.getOwnPropertyDescriptor(o,t);return r.get?r.get.call(n):r.value}},a(e,t,n||e)}function h(e){return function(e){if(Array.isArray(e))return f(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||d(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){if(e){if("string"==typeof e)return f(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?f(e,t):void 0}}function f(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function v(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=d(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var o=0,r=function(){};return{s:r,n:function(){return o>=e.length?{done:!0}:{done:!1,value:e[o++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,l=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return l=e.done,e},e:function(e){i=!0,s=e},f:function(){try{l||null==n.return||n.return()}finally{if(i)throw s}}}}function p(t,n){try{if("object"!==e(n)){var o=e(n);throw new TypeError("AccessibleMenu: Elements given to isValidInstance() must be inside of an object. ".concat(o," given."))}for(var r in n)if(!(n[r]instanceof t)){var s=e(n[r]);throw new TypeError("AccessibleMenu: ".concat(r," must be an instance of ").concat(t.name,". ").concat(s," given."))}return!0}catch(e){return console.error(e),!1}}function g(t,n){try{if("object"!==e(n)){var o=e(n);throw new TypeError("AccessibleMenu: Values given to isValidType() must be inside of an object. ".concat(o," given."))}for(var r in n){var s=e(n[r]);if(s!==t)throw new TypeError("AccessibleMenu: ".concat(r," must be a ").concat(t,". ").concat(s," given."))}return!0}catch(e){return console.error(e),!1}}function y(t){try{if("object"!==e(t)){var n=e(t);throw new TypeError("AccessibleMenu: Values given to isCSSSelector() must be inside of an object. ".concat(n," given."))}for(var o in t)try{if(null===t[o])throw new Error;document.querySelector(t[o])}catch(e){throw new TypeError("AccessibleMenu: ".concat(o,' must be a valid CSS selector. "').concat(t[o],'" given.'))}return!0}catch(e){return console.error(e),!1}}function b(t){try{if("object"!==e(t)||Array.isArray(t)){var n=e(t);throw new TypeError("AccessibleMenu: Values given to isValidClassList() must be inside of an object. ".concat(n," given."))}var o=function(n){var o=e(t[n]);if("string"!==o){if(!Array.isArray(t[n]))throw new TypeError("AccessibleMenu: ".concat(n," must be a string or an array of strings. ").concat(o," given."));t[n].forEach((function(e){if("string"!=typeof e)throw new TypeError("AccessibleMenu: ".concat(n," must be a string or an array of strings. An array containing non-strings given."))}))}else{var r={};r[n]=t[n],y(r)}};for(var r in t)o(r);return!0}catch(e){return console.error(e),!1}}function M(t){try{if("object"!==e(t)){var n=e(t);throw new TypeError("AccessibleMenu: Values given to isValidHoverType() must be inside of an object. ".concat(n," given."))}var o=["off","on","dynamic"];for(var r in t)if(!o.includes(t[r]))throw new TypeError("AccessibleMenu: ".concat(r," must be one of the following values: ").concat(o.join(", "),'. "').concat(t[r],'" given.'));return!0}catch(e){return console.error(e),!1}}function E(e,t){return!(!g("string",{event:e})||!p(HTMLElement,{element:t}))&&void 0!==t["on".concat(e)]}var _=function(){function e(n){var o=n.menuToggleElement,s=n.parentElement,l=n.controlledMenu,i=n.parentMenu,u=void 0===i?null:i;t(this,e),r(this,"_dom",{toggle:null,parent:null}),r(this,"_elements",{controlledMenu:null,parentMenu:null}),r(this,"_open",!1),r(this,"_expandEvent",new CustomEvent("accessibleMenuExpand",{bubbles:!0,detail:{toggle:this}})),r(this,"_collapseEvent",new CustomEvent("accessibleMenuCollapse",{bubbles:!0,detail:{toggle:this}})),this._dom.toggle=o,this._dom.parent=s,this._elements.controlledMenu=l,this._elements.parentMenu=u}return o(e,[{key:"initialize",value:function(){if(this.dom.toggle.setAttribute("aria-haspopup","true"),this.dom.toggle.setAttribute("aria-expanded","false"),function(e,t){if(g("string",{tagName:e})&&p(HTMLElement,t)){var n=e.toLowerCase(),o=!0;for(var r in t)t[r].tagName.toLowerCase()!==n&&(o=!1);return o}return!1}("button",{toggle:this.dom.toggle})||this.dom.toggle.setAttribute("role","button"),""===this.dom.toggle.id||""===this.elements.controlledMenu.dom.menu.id){var e=Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,10),t=this.dom.toggle.innerText.replace(/[^a-zA-Z0-9\s]/g,""),n=e;!t.replace(/\s/g,"").length&&this.dom.toggle.getAttribute("aria-label")&&(t=this.dom.toggle.getAttribute("aria-label").replace(/[^a-zA-Z0-9\s]/g,"")),t.replace(/\s/g,"").length>0&&((t=t.toLowerCase().replace(/\s+/g,"-")).startsWith("-")&&(t=t.substring(1)),t.endsWith("-")&&(t=t.slice(0,-1)),n="".concat(t,"-").concat(n)),this.dom.toggle.id=this.dom.toggle.id||"".concat(n,"-menu-button"),this.elements.controlledMenu.dom.menu.id=this.elements.controlledMenu.dom.menu.id||"".concat(n,"-menu")}this.elements.controlledMenu.dom.menu.setAttribute("aria-labelledby",this.dom.toggle.id),this.dom.toggle.setAttribute("aria-controls",this.elements.controlledMenu.dom.menu.id),this._collapse(!1)}},{key:"dom",get:function(){return this._dom}},{key:"elements",get:function(){return this._elements}},{key:"isOpen",get:function(){return this._open},set:function(e){g("boolean",{value:e}),this._open=e}},{key:"_expand",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=this.elements.controlledMenu,r=o.closeClass,s=o.openClass;(this.dom.toggle.setAttribute("aria-expanded","true"),""!==s)&&("string"==typeof s?this.elements.controlledMenu.dom.menu.classList.add(s):(e=this.elements.controlledMenu.dom.menu.classList).add.apply(e,h(s)));""!==r&&("string"==typeof r?this.elements.controlledMenu.dom.menu.classList.remove(r):(t=this.elements.controlledMenu.dom.menu.classList).remove.apply(t,h(r)));n&&this.dom.toggle.dispatchEvent(this._expandEvent)}},{key:"_collapse",value:function(){var e,t,n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],o=this.elements.controlledMenu,r=o.closeClass,s=o.openClass;(this.dom.toggle.setAttribute("aria-expanded","false"),""!==r)&&("string"==typeof r?this.elements.controlledMenu.dom.menu.classList.add(r):(e=this.elements.controlledMenu.dom.menu.classList).add.apply(e,h(r)));""!==s&&("string"==typeof s?this.elements.controlledMenu.dom.menu.classList.remove(s):(t=this.elements.controlledMenu.dom.menu.classList).remove.apply(t,h(s)));n&&this.dom.toggle.dispatchEvent(this._collapseEvent)}},{key:"open",value:function(){this.elements.controlledMenu.focusState="self",this._expand(),this.isOpen=!0}},{key:"preview",value:function(){this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"),this._expand(),this.isOpen=!0}},{key:"close",value:function(){this.isOpen&&(this.elements.controlledMenu.currentChild=0,this.elements.controlledMenu.blur(),this.elements.parentMenu&&(this.elements.parentMenu.focusState="self"),this._collapse(),this.isOpen=!1)}},{key:"toggle",value:function(){this.isOpen?this.close():this.open()}},{key:"closeSiblings",value:function(){var e=this;this.elements.parentMenu&&this.elements.parentMenu.elements.submenuToggles.forEach((function(t){t!==e&&t.close()}))}},{key:"closeChildren",value:function(){this.elements.controlledMenu.elements.submenuToggles.forEach((function(e){return e.close()}))}}]),e}(),C=function(){function e(n){var o=n.menuItemElement,s=n.menuLinkElement,l=n.parentMenu,i=n.isSubmenuItem,u=void 0!==i&&i,c=n.childMenu,m=void 0===c?null:c,a=n.toggle,h=void 0===a?null:a;t(this,e),r(this,"_dom",{item:null,link:null}),r(this,"_elements",{parentMenu:null,childMenu:null,toggle:null}),r(this,"_submenu",!1),this._dom.item=o,this._dom.link=s,this._elements.parentMenu=l,this._elements.childMenu=m,this._elements.toggle=h,this._submenu=u}return o(e,[{key:"initialize",value:function(){}},{key:"dom",get:function(){return this._dom}},{key:"elements",get:function(){return this._elements}},{key:"isSubmenuItem",get:function(){return this._submenu}},{key:"focus",value:function(){this.elements.parentMenu.shouldFocus&&this.dom.link.focus()}},{key:"blur",value:function(){this.elements.parentMenu.shouldFocus&&this.dom.link.blur()}}]),e}();function T(e){try{var t=e.key||e.keyCode,n={Enter:"Enter"===t||13===t,Space:" "===t||"Spacebar"===t||32===t,Escape:"Escape"===t||"Esc"===t||27===t,ArrowUp:"ArrowUp"===t||"Up"===t||38===t,ArrowRight:"ArrowRight"===t||"Right"===t||39===t,ArrowDown:"ArrowDown"===t||"Down"===t||40===t,ArrowLeft:"ArrowLeft"===t||"Left"===t||37===t,Home:"Home"===t||36===t,End:"End"===t||35===t,Character:isNaN(t)&&!!t.match(/^[a-zA-Z]{1}$/),Tab:"Tab"===t||9===t,Asterisk:"*"===t||56===t};return Object.keys(n).find((function(e){return!0===n[e]}))||""}catch(e){return""}}function I(e){e.preventDefault(),e.stopPropagation()}var k=function(){function n(e){var o=e.menuElement,s=e.menuItemSelector,l=void 0===s?"li":s,i=e.menuLinkSelector,u=void 0===i?"a":i,c=e.submenuItemSelector,m=void 0===c?"":c,a=e.submenuToggleSelector,h=void 0===a?"a":a,d=e.submenuSelector,f=void 0===d?"ul":d,v=e.controllerElement,p=void 0===v?null:v,g=e.containerElement,y=void 0===g?null:g,b=e.openClass,M=void 0===b?"show":b,E=e.closeClass,T=void 0===E?"hide":E,I=e.isTopLevel,k=void 0===I||I,w=e.parentMenu,S=void 0===w?null:w,L=e.hoverType,A=void 0===L?"off":L,O=e.hoverDelay,D=void 0===O?250:O;t(this,n),r(this,"_MenuType",n),r(this,"_MenuItemType",C),r(this,"_MenuToggleType",_),r(this,"_dom",{menu:null,menuItems:[],submenuItems:[],submenuToggles:[],submenus:[],controller:null,container:null}),r(this,"_selectors",{menuItems:"",menuLinks:"",submenuItems:"",submenuToggles:"",submenus:""}),r(this,"_elements",{menuItems:[],submenuToggles:[],controller:null,parentMenu:null,rootMenu:null}),r(this,"_openClass","show"),r(this,"_closeClass","hide"),r(this,"_root",!0),r(this,"_currentChild",0),r(this,"_focusState","none"),r(this,"_currentEvent","none"),r(this,"_hoverType","off"),r(this,"_hoverDelay",250),this._dom.menu=o,this._dom.controller=p,this._dom.container=y,this._selectors.menuItems=l,this._selectors.menuLinks=u,this._selectors.submenuItems=m,this._selectors.submenuToggles=h,this._selectors.submenus=f,this._elements.menuItems=[],this._elements.submenuToggles=[],this._elements.controller=null,this._elements.parentMenu=S,this._elements.rootMenu=k?this:null,this._openClass=M||"",this._closeClass=T||"",this._root=k,this._hoverType=A,this._hoverDelay=D}return o(n,[{key:"initialize",value:function(){if(!this._validate())throw new Error("AccesibleMenu: cannot initialize menu. See other error messages for more information.");if(null===this.elements.rootMenu&&this._findRootMenu(this),this._setDOMElements(),this.isTopLevel&&this.dom.controller&&this.dom.container){var e=new this._MenuToggleType({menuToggleElement:this.dom.controller,parentElement:this.dom.container,controlledMenu:this});this._elements.controller=e}this._createChildElements()}},{key:"dom",get:function(){return this._dom}},{key:"selectors",get:function(){return this._selectors}},{key:"elements",get:function(){return this._elements}},{key:"isTopLevel",get:function(){return this._root}},{key:"openClass",get:function(){return this.isTopLevel?this._openClass:this.elements.rootMenu.openClass},set:function(e){b({openClass:e}),this._openClass!==e&&(this._openClass=e)}},{key:"closeClass",get:function(){return this.isTopLevel?this._closeClass:this.elements.rootMenu.closeClass},set:function(e){b({closeClass:e}),this._closeClass!==e&&(this._closeClass=e)}},{key:"currentChild",get:function(){return this._currentChild},set:function(e){function t(e){if(["mouse","character"].includes(e.currentEvent)&&e.elements.parentMenu)for(var t=0,n=!1;!n&&t<e.elements.parentMenu.elements.menuItems.length;){var o=e.elements.parentMenu.elements.menuItems[t];o.isSubmenuItem&&o.elements.toggle.elements.controlledMenu===e&&(n=!0,e.elements.parentMenu.currentEvent=e.currentEvent,e.elements.parentMenu.currentChild=t),t++}}g("number",{value:e}),e<-1?(this._currentChild=-1,t(this)):e>=this.elements.menuItems.length?(this._currentChild=this.elements.menuItems.length-1,t(this)):this.focusChild!==e&&(this._currentChild=e,t(this))}},{key:"focusState",get:function(){return this._focusState},set:function(t){!function(t){try{if("object"!==e(t)){var n=e(t);throw new TypeError("AccessibleMenu: Values given to isValidState() must be inside of an object. ".concat(n," given."))}var o=["none","self","child"];for(var r in t)if(!o.includes(t[r]))throw new TypeError("AccessibleMenu: ".concat(r," must be one of the following values: ").concat(o.join(", "),'. "').concat(t[r],'" given.'))}catch(e){return console.error(e),!1}}({value:t}),this._focusState!==t&&(this._focusState=t),this.elements.submenuToggles.length>0&&("self"===t||"none"===t)&&this.elements.submenuToggles.forEach((function(e){e.elements.controlledMenu.focusState="none"})),!this.elements.parentMenu||"self"!==t&&"child"!==t||(this.elements.parentMenu.focusState="child")}},{key:"currentEvent",get:function(){return this._currentEvent},set:function(t){!function(t){try{if("object"!==e(t)){var n=e(t);throw new TypeError("AccessibleMenu: Values given to isValidEvent() must be inside of an object. ".concat(n," given."))}var o=["none","mouse","keyboard","character"];for(var r in t)if(!o.includes(t[r]))throw new TypeError("AccessibleMenu: ".concat(r," must be one of the following values: ").concat(o.join(", "),'. "').concat(t[r],'" given.'))}catch(e){return console.error(e),!1}}({value:t}),this._currentEvent!==t&&(this._currentEvent=t,this.elements.submenuToggles.length>0&&this.elements.submenuToggles.forEach((function(e){e.elements.controlledMenu.currentEvent=t})))}},{key:"currentMenuItem",get:function(){return this.elements.menuItems[this.currentChild]}},{key:"hoverType",get:function(){return this._root?this._hoverType:this.elements.rootMenu.hoverType},set:function(e){M({value:e}),this._hoverType!==e&&(this._hoverType=e)}},{key:"hoverDelay",get:function(){return this._root?this._hoverDelay:this.elements.rootMenu.hoverDelay},set:function(e){g("number",{value:e}),this._hoverDelay!==e&&(this._hoverDelay=e)}},{key:"shouldFocus",get:function(){var e=!1;return"keyboard"!==this.currentEvent&&"character"!==this.currentEvent||(e=!0),"mouse"===this.currentEvent&&"dynamic"===this.hoverType&&(e=!0),e}},{key:"_validate",value:function(){var e=!0;return null!==this._dom.container||null!==this._dom.controller?p(HTMLElement,{menuElement:this._dom.menu,controllerElement:this._dom.controller,containerElement:this._dom.container})||(e=!1):p(HTMLElement,{menuElement:this._dom.menu})||(e=!1),""!==this._selectors.submenuItems?y({menuItemSelector:this._selectors.menuItems,menuLinkSelector:this._selectors.menuLinks,submenuItemSelector:this._selectors.submenuItems,submenuToggleSelector:this._selectors.submenuToggles,submenuSelector:this._selectors.submenus})||(e=!1):y({menuItemSelector:this._selectors.menuItems,menuLinkSelector:this._selectors.menuLinks})||(e=!1),""===this._openClass||b({openClass:this._openClass})||(e=!1),""===this._closeClass||b({closeClass:this._closeClass})||(e=!1),g("boolean",{isTopLevel:this._root})||(e=!1),null===this._elements.parentMenu||p(n,{parentMenu:this._elements.parentMenu})||(e=!1),M({hoverType:this._hoverType})||(e=!1),g("number",{hoverDelay:this._hoverDelay})||(e=!1),e}},{key:"_setDOMElementType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.dom.menu,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if("string"!=typeof this.selectors[e])throw new Error('AccessibleMenu: "'.concat(e,'" is not a valid element type within the menu.'));if(!Array.isArray(this.dom[e]))throw new Error('AccessibleMenu: The "'.concat(e,'" element cannot be set through _setDOMElementType.'));t!==this.dom.menu&&p(HTMLElement,{base:t});var o=Array.from(t.querySelectorAll(this.selectors[e])),r=o.filter((function(e){return e.parentElement===t}));this._dom[e]=n?r:[].concat(h(this._dom[e]),h(r))}},{key:"_resetDOMElementType",value:function(e){if(void 0===this.dom[e])throw new Error('AccessibleMenu: "'.concat(e,'" is not a valid element type within the menu.'));if(!Array.isArray(this.dom[e]))throw new Error('AccessibleMenu: The "'.concat(e,'" element cannot be reset through _resetDOMElementType.'));this._dom[e]=[]}},{key:"_setDOMElements",value:function(){var e=this;this._setDOMElementType("menuItems"),""!==this.selectors.submenuItems&&(this._setDOMElementType("submenuItems"),this._resetDOMElementType("submenuToggles"),this._resetDOMElementType("submenus"),this.dom.submenuItems.forEach((function(t){e._setDOMElementType("submenuToggles",t,!1),e._setDOMElementType("submenus",t,!1)})))}},{key:"_findRootMenu",value:function(e){if(e.isTopLevel)this._elements.rootMenu=e;else{if(null===e.elements.parentMenu)throw new Error("Cannot find root menu.");this._findRootMenu(e.elements.parentMenu)}}},{key:"_createChildElements",value:function(){var e=this;this.dom.menuItems.forEach((function(t){var n;if(e.dom.submenuItems.includes(t)){var o=t.querySelector(e.selectors.submenuToggles),r=t.querySelector(e.selectors.submenus),s=new e._MenuType({menuElement:r,menuItemSelector:e.selectors.menuItems,menuLinkSelector:e.selectors.menuLinks,submenuItemSelector:e.selectors.submenuItems,submenuToggleSelector:e.selectors.submenuToggles,submenuSelector:e.selectors.submenus,openClass:e.openClass,closeClass:e.closeClass,isTopLevel:!1,parentMenu:e,hoverType:e.hoverType,hoverDelay:e.hoverDelay}),l=new e._MenuToggleType({menuToggleElement:o,parentElement:t,controlledMenu:s,parentMenu:e});e._elements.submenuToggles.push(l),n=new e._MenuItemType({menuItemElement:t,menuLinkElement:o,parentMenu:e,isSubmenuItem:!0,childMenu:s,toggle:l})}else{var i=t.querySelector(e.selectors.menuLinks);n=new e._MenuItemType({menuItemElement:t,menuLinkElement:i,parentMenu:e})}e._elements.menuItems.push(n)}))}},{key:"_handleFocus",value:function(){var e=this;this.elements.menuItems.forEach((function(t,n){t.dom.link.addEventListener("focus",(function(){e.focusState="self",e.currentChild=n}))}))}},{key:"_handleClick",value:function(){var e=this,t=E("touchstart",this.dom.menu)?"touchstart":"mousedown",n=E("touchend",this.dom.menu)?["touchend","mouseup"]:["mouseup"];function o(e,t,n){I(n),t.toggle(),t.isOpen&&(e.focusState="self",t.elements.controlledMenu.focusState="none")}if(this.elements.menuItems.forEach((function(r,s){if(r.dom.link.addEventListener(t,(function(){e.currentEvent="mouse",e.elements.rootMenu.blurChildren(),e.focusChild(s)}),{passive:!0}),r.isSubmenuItem){var l,i=v(n);try{for(i.s();!(l=i.n()).done;){var u=l.value;r.elements.toggle.dom.toggle["on".concat(u)]=function(t){e.currentEvent="mouse",o(e,r.elements.toggle,t)}}}catch(e){i.e(e)}finally{i.f()}}})),this.isTopLevel&&this.elements.controller){var r,s=v(n);try{for(s.s();!(r=s.n()).done;){var l=r.value;this.elements.controller.dom.toggle["on".concat(l)]=function(t){e.currentEvent="mouse",o(e,e.elements.controller,t)}}}catch(e){s.e(e)}finally{s.f()}}}},{key:"_handleHover",value:function(){var e=this;this.elements.menuItems.forEach((function(t,n){t.dom.link.addEventListener("mouseenter",(function(){if("on"===e.hoverType)e.currentEvent="mouse",e.currentChild=n,t.isSubmenuItem&&t.elements.toggle.preview();else if("dynamic"===e.hoverType){var o=e.elements.submenuToggles.some((function(e){return e.isOpen}));e.currentChild=n,e.isTopLevel&&"none"===e.focusState||(e.currentEvent="mouse",e.focusCurrentChild()),!t.isSubmenuItem||e.isTopLevel&&!o||(e.currentEvent="mouse",t.elements.toggle.preview())}})),t.isSubmenuItem&&t.dom.item.addEventListener("mouseleave",(function(){"on"===e.hoverType?e.hoverDelay>0?setTimeout((function(){e.currentEvent="mouse",t.elements.toggle.close()}),e.hoverDelay):(e.currentEvent="mouse",t.elements.toggle.close()):"dynamic"===e.hoverType&&(e.isTopLevel||(e.hoverDelay>0?setTimeout((function(){e.currentEvent="mouse",t.elements.toggle.close(),e.focusCurrentChild()}),e.hoverDelay):(e.currentEvent="mouse",t.elements.toggle.close(),e.focusCurrentChild())))}))}))}},{key:"_handleKeydown",value:function(){var e=this;this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keydown",(function(t){e.currentEvent="keyboard";var n=T(t);"Space"!==n&&"Enter"!==n||I(t)}))}},{key:"_handleKeyup",value:function(){var e=this;this.isTopLevel&&this.elements.controller&&this.elements.controller.dom.toggle.addEventListener("keyup",(function(t){e.currentEvent="keyboard";var n=T(t);"Space"!==n&&"Enter"!==n||(I(t),e.elements.controller.open(),e.focusFirstChild())}))}},{key:"focus",value:function(){this.focusState="self",this.shouldFocus&&this.dom.menu.focus()}},{key:"blur",value:function(){this.focusState="none",this.shouldFocus&&this.dom.menu.blur()}},{key:"focusCurrentChild",value:function(){this.focusState="self",-1!==this.currentChild&&this.currentMenuItem.focus()}},{key:"focusChild",value:function(e){this.blurCurrentChild(),this.currentChild=e,this.focusCurrentChild()}},{key:"focusFirstChild",value:function(){this.focusChild(0)}},{key:"focusLastChild",value:function(){this.focusChild(this.elements.menuItems.length-1)}},{key:"focusNextChild",value:function(){this.currentChild<this.elements.menuItems.length-1?this.focusChild(this.currentChild+1):this.focusCurrentChild()}},{key:"focusPreviousChild",value:function(){this.currentChild>0?this.focusChild(this.currentChild-1):this.focusCurrentChild()}},{key:"blurCurrentChild",value:function(){this.focusState="none",-1!==this.currentChild&&this.currentMenuItem.blur()}},{key:"focusController",value:function(){this.dom.controller&&(this.shouldFocus&&this.dom.controller.focus(),this.focusState="none")}},{key:"focusContainer",value:function(){this.dom.container&&(this.shouldFocus&&this.dom.container.focus(),this.focusState="none")}},{key:"closeChildren",value:function(){this.elements.submenuToggles.forEach((function(e){return e.close()}))}},{key:"blurChildren",value:function(){this.elements.menuItems.forEach((function(e){e.blur(),e.isSubmenuItem&&e.elements.childMenu.blurChildren()}))}}]),n}(),w=function(e){s(r,C);var n=m(r);function r(e){var o,s=e.menuItemElement,l=e.menuLinkElement,i=e.parentMenu,u=e.isSubmenuItem,c=void 0!==u&&u,m=e.childMenu,a=void 0===m?null:m,h=e.toggle,d=void 0===h?null:h,f=e.initialize,v=void 0===f||f;return t(this,r),o=n.call(this,{menuItemElement:s,menuLinkElement:l,parentMenu:i,isSubmenuItem:c,childMenu:a,toggle:d}),v&&o.initialize(),o}return o(r,[{key:"initialize",value:function(){a(l(r.prototype),"initialize",this).call(this),this.dom.item.setAttribute("role","none"),this.dom.link.setAttribute("role","treeitem"),this.dom.link.tabIndex=-1}},{key:"focus",value:function(){a(l(r.prototype),"focus",this).call(this),this.dom.link.tabIndex=0}},{key:"blur",value:function(){a(l(r.prototype),"blur",this).call(this),this.dom.link.tabIndex=-1}}]),r}(),S=function(e){s(o,_);var n=m(o);function o(e){var r,s=e.menuToggleElement,l=e.parentElement,i=e.controlledMenu,u=e.parentMenu,c=void 0===u?null:u,m=e.initialize,a=void 0===m||m;return t(this,o),r=n.call(this,{menuToggleElement:s,parentElement:l,controlledMenu:i,parentMenu:c}),a&&r.initialize(),r}return o}(),L=function(e){s(i,k);var n=m(i);function i(e){var o,s=e.menuElement,l=e.menuItemSelector,c=void 0===l?"li":l,m=e.menuLinkSelector,a=void 0===m?"a":m,h=e.submenuItemSelector,d=void 0===h?"":h,f=e.submenuToggleSelector,v=void 0===f?"a":f,p=e.submenuSelector,g=void 0===p?"ul":p,y=e.controllerElement,b=void 0===y?null:y,M=e.containerElement,E=void 0===M?null:M,_=e.openClass,C=void 0===_?"show":_,T=e.closeClass,I=void 0===T?"hide":T,k=e.isTopLevel,L=void 0===k||k,A=e.parentMenu,O=void 0===A?null:A,D=e.hoverType,j=void 0===D?"off":D,x=e.hoverDelay,N=void 0===x?250:x,z=e.initialize,R=void 0===z||z;return t(this,i),r(u(o=n.call(this,{menuElement:s,menuItemSelector:c,menuLinkSelector:a,submenuItemSelector:d,submenuToggleSelector:v,submenuSelector:g,controllerElement:b,containerElement:E,openClass:C,closeClass:I,isTopLevel:L,parentMenu:O,hoverType:j,hoverDelay:N})),"_MenuType",i),r(u(o),"_MenuItemType",w),r(u(o),"_MenuToggleType",S),R&&o.initialize(),o}return o(i,[{key:"initialize",value:function(){try{a(l(i.prototype),"initialize",this).call(this),this.isTopLevel?(this.dom.menu.setAttribute("role","tree"),this.elements.menuItems[0].dom.link.tabIndex=0):this.dom.menu.setAttribute("role","group"),this._handleFocus(),this._handleClick(),this._handleHover(),this._handleKeydown(),this._handleKeyup()}catch(e){console.error(e)}}},{key:"_handleKeydown",value:function(){var e=this;a(l(i.prototype),"_handleKeydown",this).call(this),this.dom.menu.addEventListener("keydown",(function(t){e.currentEvent="keyboard";var n=T(t);if("Tab"===n&&("none"!==e.elements.rootMenu.focusState?e.elements.rootMenu.blur():e.elements.rootMenu.focus()),"self"===e.focusState){(["Space","ArrowUp","ArrowDown","ArrowLeft","Asterisk","Home","End"].includes(n)||e.currentMenuItem.isSubmenuItem&&["Enter","ArrowRight"].includes(n)||e.elements.controller&&["Escape"].includes(n))&&I(t)}}))}},{key:"_handleKeyup",value:function(){var e=this;a(l(i.prototype),"_handleKeyup",this).call(this),this.dom.menu.addEventListener("keyup",(function(t){e.currentEvent="keyboard";var n=T(t),o=t.altKey,r=t.crtlKey,s=t.metaKey;if("Character"!==n||(o||r||s)){if("self"===e.focusState)if("Enter"===n||"Space"===n)I(t),e.currentMenuItem.isSubmenuItem?e.currentMenuItem.elements.toggle.isOpen?e.currentMenuItem.elements.toggle.close():e.currentMenuItem.elements.toggle.preview():e.currentMenuItem.dom.link.click();else if("Escape"===n)e.isTopLevel&&e.elements.controller&&e.elements.controller.isOpen&&(e.elements.controller.close(),e.focusController());else if("ArrowDown"===n)I(t),e.currentMenuItem.isSubmenuItem&&e.currentMenuItem.elements.toggle.isOpen?(e.blurCurrentChild(),e.currentMenuItem.elements.childMenu.currentEvent=e.currentEvent,e.currentMenuItem.elements.childMenu.focusFirstChild()):e.isTopLevel||e.currentChild!==e.elements.menuItems.length-1?e.focusNextChild():e.focusParentsNextChild();else if("ArrowUp"===n){I(t);var l=e.elements.menuItems[e.currentChild-1];l&&l.isSubmenuItem&&l.elements.toggle.isOpen?(e.blurCurrentChild(),e.currentChild=e.currentChild-1,e.currentMenuItem.elements.childMenu.currentEvent=e.currentEvent,e.focusChildsLastNode()):e.isTopLevel||0!==e.currentChild?e.focusPreviousChild():(e.blurCurrentChild(),e.elements.parentMenu.currentEvent=e.currentEvent,e.elements.parentMenu.focusCurrentChild())}else"ArrowRight"===n?e.currentMenuItem.isSubmenuItem&&(I(t),e.currentMenuItem.elements.toggle.isOpen?(e.blurCurrentChild(),e.currentMenuItem.elements.childMenu.currentEvent=e.currentEvent,e.currentMenuItem.elements.childMenu.focusFirstChild()):e.currentMenuItem.elements.toggle.preview()):"ArrowLeft"===n?(I(t),e.currentMenuItem.isSubmenuItem&&e.currentMenuItem.elements.toggle.isOpen?(e.currentMenuItem.elements.childMenu.blurCurrentChild(),e.currentMenuItem.elements.toggle.close()):e.isTopLevel||(e.blurCurrentChild(),e.elements.parentMenu.currentEvent=e.currentEvent,e.elements.parentMenu.focusCurrentChild())):"Home"===n?(I(t),e.blurCurrentChild(),e.elements.rootMenu.focusFirstChild()):"End"===n?(I(t),e.blurCurrentChild(),e.elements.rootMenu.focusLastNode()):"Asterisk"===n&&(I(t),e.openChildren())}else I(t),e.elements.rootMenu.currentEvent="character",e.focusNextNodeWithCharacter(t.key)}))}},{key:"focusLastNode",value:function(){var e=this.elements.menuItems.length-1,t=this.elements.menuItems[e];t.isSubmenuItem&&t.elements.toggle.isOpen?(this.currentChild=e,t.elements.childMenu.currentEvent=this.currentEvent,t.elements.childMenu.focusLastNode()):this.focusLastChild()}},{key:"openChildren",value:function(){this.elements.submenuToggles.forEach((function(e){return e.preview()}))}},{key:"focusNextNodeWithCharacter",value:function(e){for(var t=e.toLowerCase(),n=function e(t){var n=[];return t.elements.menuItems.forEach((function(t){n.push(t),t.isSubmenuItem&&t.elements.toggle.isOpen&&(n=[].concat(h(n),h(e(t.elements.toggle.elements.controlledMenu))))})),n}(this.elements.rootMenu),o=n.indexOf(this.currentMenuItem)+1,r=[].concat(h(n.slice(o)),h(n.slice(0,o))),s=0,l=!1;!l&&s<r.length;){if((r[s].dom.item.innerText?r[s].dom.item.innerText:r[s].dom.item.textContent).replace(/[\s]/g,"").toLowerCase().charAt(0)===t){l=!0;var i=r[s].elements.parentMenu,u=i.elements.menuItems.indexOf(r[s]);this.elements.rootMenu.blurChildren(),i.focusChild(u)}s++}}},{key:"focusParentsNextChild",value:function(){this.elements.parentMenu&&(this.elements.parentMenu.currentEvent=this.currentEvent,this.elements.parentMenu.currentChild===this.elements.parentMenu.elements.menuItems.length-1?(this.elements.parentMenu.blurCurrentChild(),this.elements.parentMenu.focusParentsNextChild()):(this.blurChildren(),this.elements.parentMenu.focusNextChild()))}},{key:"focusChildsLastNode",value:function(){this.currentMenuItem.elements.childMenu.currentEvent=this.currentEvent,this.currentMenuItem.elements.childMenu.focusLastChild(),this.currentMenuItem.elements.childMenu.currentMenuItem.isSubmenuItem&&this.currentMenuItem.elements.childMenu.currentMenuItem.elements.toggle.isOpen&&(this.currentMenuItem.elements.childMenu.blurCurrentChild(),this.currentMenuItem.elements.childMenu.focusChildsLastNode())}}]),i}();export{L as default};
//# sourceMappingURL=treeview.esm.min.js.map
